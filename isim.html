<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>İŞİM — CV paylaş</title>
  <style>
    :root{--bg:#f7fafc;--card:#fff;--muted:#6b7280;--accent:#2563eb;--accent2:#fb923c}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,'Helvetica Neue',Arial; margin:0; background:var(--bg); color:#0f172a}
    .container{max-width:960px;margin:24px auto;padding:18px}
    header{background:var(--card);padding:14px;border-radius:10px;display:flex;align-items:center;gap:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
    .logo{width:48px;height:48px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:13px}

    .grid{display:grid;gap:16px}
    .two{grid-template-columns:1fr 360px}

    .card{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(15,23,42,0.04)}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input[type="text"], textarea{width:100%;padding:10px;border:1px solid #e6e9ee;border-radius:8px;font-size:14px}
    input[type=file]{font-size:13px}
    button{background:var(--accent);color:white;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
    .btn-outline{background:transparent;border:1px solid #e6e9ee;color:var(--muted)}
    .small{font-size:13px;color:var(--muted)}

    .list{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px;margin-top:12px}
    .cv-card{display:flex;gap:12px;align-items:flex-start}
    .avatar{width:68px;height:68px;border-radius:8px;background:#f1f5f9;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .avatar img{width:100%;height:100%;object-fit:cover}
    .meta{flex:1}
    .meta .name{font-weight:700}
    .meta .role{color:var(--muted);font-size:13px}
    .meta .summary{margin-top:6px;color:#334155;font-size:13px}
    .actions{display:flex;gap:8px;margin-top:8px}
    .actions button{padding:8px 10px;border-radius:8px;font-size:13px}
    .muted{color:var(--muted)}
    footer{margin-top:20px;color:var(--muted);font-size:13px;text-align:center}

    @media(max-width:800px){.two{grid-template-columns:1fr} .container{padding:12px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">İŞ</div>
      <div>
        <h1>İŞİM</h1>
        <p class="lead">Sadə CV paylaşım platforması — bütün məlumatlar yalnız sənin brauzerdə saxlanır.</p>
      </div>
    </header>

    <main class="grid two" style="margin-top:18px">
      <section class="card">
        <h2 style="margin-top:0">CV yerləşdir</h2>
        <form id="cvForm">
          <div style="margin-top:8px">
            <label>Ad Soyad *</label>
            <input type="text" id="name" placeholder="Məsələn: Əli Abasov" required />
          </div>

          <div style="margin-top:8px">
            <label>Peşə *</label>
            <input type="text" id="profession" placeholder="Məsələn: Frontend developer" required />
          </div>

          <div style="margin-top:8px">
            <label>Qısa təcrübə / bacarıqlar</label>
            <textarea id="summary" rows="4" placeholder="Qısa izahat... (opsional)"></textarea>
          </div>

          <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
            <div style="flex:1">
              <label>Profil şəkli</label>
              <input type="file" id="image" accept="image/*" />
            </div>
            <div style="flex:1">
              <label>CV faylı (PDF / DOC)</label>
              <input type="file" id="cvfile" accept=".pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" />
            </div>
          </div>

          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
            <div class="small">Fayllar serverə göndərilmir — yalnız localStorage.</div>
            <div style="display:flex;gap:8px">
              <button type="button" id="clearBtn" class="btn-outline">Təmizlə</button>
              <button type="submit">Yerləşdir</button>
            </div>
          </div>
        </form>
      </section>

      <aside class="card">
        <h3 style="margin-top:0">Qısa təlimat</h3>
        <p class="small">Bu səhifədə yerləşdirilən CV-lər yalnız SƏNİN brauzerdə saxlanır. Başqasının kompüterində görünməyəcək. Səhifəni silsən və ya brauzerin cache-i təmizlənərsə, məlumatlar itə bilər.</p>

        <div style="margin-top:10px">
          <strong>Faylların ölçüsü:</strong>
          <div class="small" style="margin-top:6px">Böyük fayllar brauzer yaddaşını istifadə edərək yavaşlaya bilər. Sadəcə lazım olan faylı yükləyin.</div>
        </div>
      </aside>
    </main>

    <section class="card" style="margin-top:14px">
      <h2 style="margin:0 0 8px 0">Yerləşdirilmiş CV-lər</h2>
      <div id="list" class="list"></div>
    </section>

    <footer>© <span id="year"></span> İŞİM — Lokal CV platforması</footer>
  </div>

  <script>
    const storageKey = 'isim_cvs_html_v1';
    document.getElementById('year').textContent = new Date().getFullYear();

    // helpers
    function readFileAsDataURL(file){
      return new Promise((res, rej)=>{
        const r = new FileReader();
        r.onload = ()=>res(r.result);
        r.onerror = rej;
        r.readAsDataURL(file);
      });
    }

    function load(){
      const raw = localStorage.getItem(storageKey);
      try{ return raw ? JSON.parse(raw) : []; }catch(e){console.error(e); return [];}
    }

    function save(arr){ localStorage.setItem(storageKey, JSON.stringify(arr)); }

    function render(){
      const list = document.getElementById('list');
      const items = load();
      list.innerHTML = '';
      if(items.length === 0){ list.innerHTML = '<div class="card muted">Hələ heç bir CV yerləşdirilməyib.</div>'; return; }
      for(const it of items){
        const card = document.createElement('div'); card.className = 'card cv-card';
        const avatar = document.createElement('div'); avatar.className = 'avatar';
        if(it.image){ const img = document.createElement('img'); img.src = it.image; img.alt = it.name; avatar.appendChild(img); } else { avatar.textContent = 'Şəkil yox'; avatar.style.color = '#94a3b8'; }
        const meta = document.createElement('div'); meta.className = 'meta';
        meta.innerHTML = `<div class="name">${escapeHtml(it.name)}</div><div class="role">${escapeHtml(it.profession)}</div><div class="summary">${escapeHtml(it.summary || '—')}</div>`;
        const actions = document.createElement('div'); actions.className = 'actions';

        if(it.cv && it.cv.data){
          const down = document.createElement('button'); down.textContent = 'CV-ni endir'; down.onclick = ()=>downloadDataUrl(it.cv.data, it.cv.filename || 'cv.pdf');
          const open = document.createElement('button'); open.textContent = 'Aç'; open.onclick = ()=>window.open(it.cv.data, '_blank');
          actions.appendChild(down); actions.appendChild(open);
        } else {
          const nofile = document.createElement('div'); nofile.className = 'small muted'; nofile.textContent = 'Fayl yüklənməyib'; actions.appendChild(nofile);
        }

        const del = document.createElement('button'); del.textContent = 'Sil'; del.style.background='transparent'; del.style.color='#ef4444'; del.onclick = ()=>{ if(confirm('CV silinsin?')){ deleteItem(it.id); }};
        actions.appendChild(del);

        meta.appendChild(actions);
        card.appendChild(avatar);
        card.appendChild(meta);
        list.appendChild(card);
      }
    }

    function escapeHtml(s){ if(!s) return ''; return s.replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;" }[c])); }

    function downloadDataUrl(dataUrl, filename){
      const a = document.createElement('a'); a.href = dataUrl; a.download = filename; document.body.appendChild(a); a.click(); a.remove();
    }

    function deleteItem(id){ const arr = load().filter(x=>x.id !== id); save(arr); render(); }

    // Form logic
    document.getElementById('cvForm').addEventListener('submit', async function(e){
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const profession = document.getElementById('profession').value.trim();
      const summary = document.getElementById('summary').value.trim();
      if(!name || !profession){ alert('Ad və peşəni daxil edin.'); return; }

      const imageFile = document.getElementById('image').files[0];
      const cvFile = document.getElementById('cvfile').files[0];
      let imageData = null, cvData = null;
      if(imageFile) try{ imageData = await readFileAsDataURL(imageFile); }catch(e){console.error(e);} 
      if(cvFile) try{ const data = await readFileAsDataURL(cvFile); cvData = { filename: cvFile.name, data }; }catch(e){console.error(e);} 

      const entry = { id: Date.now(), name, profession, summary, image: imageData, cv: cvData };
      const arr = load(); arr.unshift(entry); save(arr); render();

      // clear form
      document.getElementById('cvForm').reset();
    });

    document.getElementById('clearBtn').addEventListener('click', ()=>{ document.getElementById('cvForm').reset(); });

    // init
    render();
  </script>
</body>
</html>